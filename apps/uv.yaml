name: uv

version:
  policy: latest

# cf. https://docs.astral.sh/uv/getting-started/installation/
install:
  - type: brew
    package: uv
    os: macos

  - type: custom
    os: linux
    check: command -v uv
    version_cmd: uv self version 2>/dev/null | awk '{print $2}'
    latest_cmd: curl -sS --max-time 10 "https://api.github.com/repos/astral-sh/uv/releases/latest" | jq -r '.tag_name'
    script: |
      curl -LsSf https://astral.sh/uv/install.sh | sh
    uninstall: |
      uv cache clean
      rm -r "$(uv python dir)" 2>/dev/null
      rm -r "$(uv tool dir)" 2>/dev/null
      rm -f ~/.local/bin/uv ~/.local/bin/uvx
