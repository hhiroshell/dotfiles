name: google-chrome

# cf. https://www.google.com/chrome/
install:
  - type: brew
    cask: google-chrome
    os: macos

  - type: custom
    os: linux
    check: command -v google-chrome
    version_cmd: google-chrome --version 2>/dev/null | awk '{print $NF}'
    latest_cmd: curl -sS --max-time 10 "https://versionhistory.googleapis.com/v1/chrome/platforms/linux/channels/stable/versions" | jq -r '.versions[0].version'
    script: |
      wget -q -O /tmp/google-chrome.deb https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
      sudo dpkg -i /tmp/google-chrome.deb || sudo apt-get install -f -y
      rm /tmp/google-chrome.deb
    uninstall: |
      sudo apt-get remove -y google-chrome-stable
